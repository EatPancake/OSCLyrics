"use strict";const{existsSync,readFileSync}=require("fs"),{join}=require("path"),{platform,arch}=process;let nativeBinding=null,localFileExisted=!1,loadError=null;function isMusl(){if(!process.report||typeof process.report.getReport!="function")try{const o=require("child_process").execSync("which ldd").toString().trim();return readFileSync(o,"utf8").includes("musl")}catch{return!0}else{const{glibcVersionRuntime:o}=process.report.getReport().header;return!o}}switch(platform){case"android":switch(arch){case"arm64":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.android-arm64.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.android-arm64.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-android-arm64")}catch(o){loadError=o}break;case"arm":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.android-arm-eabi.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.android-arm-eabi.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-android-arm-eabi")}catch(o){loadError=o}break;default:throw new Error(`Unsupported architecture on Android ${arch}`)}break;case"win32":switch(arch){case"x64":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.win32-x64-msvc.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.win32-x64-msvc.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-win32-x64-msvc")}catch(o){loadError=o}break;case"ia32":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.win32-ia32-msvc.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.win32-ia32-msvc.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-win32-ia32-msvc")}catch(o){loadError=o}break;case"arm64":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.win32-arm64-msvc.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.win32-arm64-msvc.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-win32-arm64-msvc")}catch(o){loadError=o}break;default:throw new Error(`Unsupported architecture on Windows: ${arch}`)}break;case"darwin":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.darwin-universal.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.darwin-universal.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-darwin-universal");break}catch{}switch(arch){case"x64":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.darwin-x64.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.darwin-x64.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-darwin-x64")}catch(o){loadError=o}break;case"arm64":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.darwin-arm64.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.darwin-arm64.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-darwin-arm64")}catch(o){loadError=o}break;default:throw new Error(`Unsupported architecture on macOS: ${arch}`)}break;case"freebsd":if(arch!=="x64")throw new Error(`Unsupported architecture on FreeBSD: ${arch}`);localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.freebsd-x64.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.freebsd-x64.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-freebsd-x64")}catch(o){loadError=o}break;case"linux":switch(arch){case"x64":if(isMusl()){localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-x64-musl.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-x64-musl.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-x64-musl")}catch(o){loadError=o}}else{localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-x64-gnu.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-x64-gnu.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-x64-gnu")}catch(o){loadError=o}}break;case"arm64":if(isMusl()){localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-arm64-musl.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-arm64-musl.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-arm64-musl")}catch(o){loadError=o}}else{localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-arm64-gnu.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-arm64-gnu.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-arm64-gnu")}catch(o){loadError=o}}break;case"arm":if(isMusl()){localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-arm-musleabihf.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-arm-musleabihf.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-arm-musleabihf")}catch(o){loadError=o}}else{localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-arm-gnueabihf.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-arm-gnueabihf.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-arm-gnueabihf")}catch(o){loadError=o}}break;case"riscv64":if(isMusl()){localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-riscv64-musl.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-riscv64-musl.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-riscv64-musl")}catch(o){loadError=o}}else{localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-riscv64-gnu.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-riscv64-gnu.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-riscv64-gnu")}catch(o){loadError=o}}break;case"s390x":localFileExisted=existsSync(join(__dirname,"windows-smtc-monitor.linux-s390x-gnu.node"));try{localFileExisted?nativeBinding=require("./windows-smtc-monitor.linux-s390x-gnu.node"):nativeBinding=require("@coooookies/windows-smtc-monitor-linux-s390x-gnu")}catch(o){loadError=o}break;default:throw new Error(`Unsupported architecture on Linux: ${arch}`)}break;default:throw new Error(`Unsupported OS: ${platform}, architecture: ${arch}`)}if(!nativeBinding)throw loadError||new Error("Failed to load native binding");const{getCurrentSession,getSessions,getSessionById,SMTCMonitor}=nativeBinding;module.exports.getCurrentSession=getCurrentSession,module.exports.getSessions=getSessions,module.exports.getSessionById=getSessionById,module.exports.SMTCMonitor=SMTCMonitor;
